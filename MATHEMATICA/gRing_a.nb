(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     68933,       2236]
NotebookOptionsPosition[     65603,       2124]
NotebookOutlinePosition[     65955,       2140]
CellTagsIndexPosition[     65912,       2137]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"$Assumptions", "=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"S", ">", "0"}], ",", 
      RowBox[{"s", ">", "0"}], ",", 
      RowBox[{"\[Sigma]", ">", "0"}], ",", 
      RowBox[{"z", ">", "0"}], ",", 
      RowBox[{"k", ">", "0"}], ",", 
      RowBox[{"L", ">", "0"}], ",", 
      RowBox[{"d", ">", "0"}], ",", 
      RowBox[{"D0", ">", "0"}], ",", 
      RowBox[{"v", ">", "0"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"kp", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "\[ImaginaryI]"}], " ", 
       RowBox[{"s", "/", "2"}]}], " ", "+", " ", 
      RowBox[{"Sqrt", "[", 
       RowBox[{
        RowBox[{"\[Lambda]", "/", "d"}], "-", 
        RowBox[{
         RowBox[{"s", "^", "2"}], "/", "4"}]}], "]"}]}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"km", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "\[ImaginaryI]"}], " ", 
       RowBox[{"s", "/", "2"}]}], " ", "-", " ", 
      RowBox[{"Sqrt", "[", 
       RowBox[{
        RowBox[{"\[Lambda]", "/", "d"}], "-", 
        RowBox[{
         RowBox[{"s", "^", "2"}], "/", "4"}]}], "]"}]}]}], ";"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"kp", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"-", "\[ImaginaryI]"}], " ", 
     RowBox[{"s", "/", "2"}]}], " ", "+", "k"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"km", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"-", "\[ImaginaryI]"}], " ", 
     RowBox[{"s", "/", "2"}]}], " ", "-", " ", "k"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"T", "=", 
   RowBox[{"(", GridBox[{
      {
       RowBox[{"Exp", "[", 
        RowBox[{"\[ImaginaryI]", " ", "kp", "*", 
         RowBox[{"L", "/", "2"}]}], "]"}], "0"},
      {"0", 
       RowBox[{"Exp", "[", 
        RowBox[{"\[ImaginaryI]", " ", "km", "*", 
         RowBox[{"L", "/", "2"}]}], "]"}]}
     }], ")"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Ta", "=", 
   RowBox[{"(", GridBox[{
      {
       RowBox[{"Exp", "[", 
        RowBox[{"\[ImaginaryI]", " ", "kp", "*", "a"}], "]"}], "0"},
      {"0", 
       RowBox[{"Exp", "[", 
        RowBox[{"\[ImaginaryI]", " ", "km", "*", "a"}], "]"}]}
     }], ")"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"U", "=", 
   RowBox[{"(", GridBox[{
      {"1", "1"},
      {
       RowBox[{"\[ImaginaryI]", "*", "kp"}], 
       RowBox[{"\[ImaginaryI]", "*", "km"}]}
     }], ")"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"M", "=", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"1", 
        RowBox[{
         RowBox[{"-", "d"}], "*", "\[Alpha]"}]},
       {"0", "1"}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
        "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"S", "=", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"1", "0"},
       {"0", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "1"}], "/", "g"}], "*", 
         RowBox[{"(", 
          RowBox[{"L", "/", "a"}], ")"}]}]}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
        "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"FullSimplify", "[", 
  RowBox[{"Det", "[", 
   RowBox[{
    RowBox[{"T", ".", 
     RowBox[{"Inverse", "[", "U", "]"}], ".", 
     RowBox[{"Inverse", "[", "S", "]"}], ".", "U", ".", "Ta", ".", 
     RowBox[{"Inverse", "[", "U", "]"}], ".", "S", ".", "U", ".", "T"}], "-", 
    
    RowBox[{"IdentityMatrix", "[", "2", "]"}]}], "]"}], "]"}]}], "Input",
 CellChangeTimes->{{3.653551686209915*^9, 3.653551921622735*^9}, {
   3.653552246337573*^9, 3.653552255056909*^9}, 3.6535528222743692`*^9, {
   3.6535532494557657`*^9, 3.6535532818551064`*^9}, {3.653554359109963*^9, 
   3.653554362413306*^9}, {3.653554861841251*^9, 3.653554869326825*^9}, {
   3.653558316163478*^9, 3.653558322495912*^9}}],

Cell[BoxData[
 RowBox[{
  FractionBox["1", 
   RowBox[{"16", " ", "a", " ", "g", " ", 
    SuperscriptBox["k", "2"], " ", "L"}]], 
  RowBox[{
   SuperscriptBox["\[ExponentialE]", 
    RowBox[{
     RowBox[{"-", "\[ImaginaryI]"}], " ", "k", " ", 
     RowBox[{"(", 
      RowBox[{"a", "+", "L"}], ")"}]}]], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      SuperscriptBox["a", "2"], " ", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{
        FractionBox["1", "2"], " ", 
        RowBox[{"(", 
         RowBox[{"a", "+", "L"}], ")"}], " ", "s"}]], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", 
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{"2", " ", "\[ImaginaryI]", " ", "a", " ", "k"}]]}], ")"}], 
      " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", 
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{"2", " ", "\[ImaginaryI]", " ", "k", " ", "L"}]]}], ")"}], 
      " ", 
      SuperscriptBox["g", "2"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"4", " ", 
         SuperscriptBox["k", "2"]}], "+", 
        SuperscriptBox["s", "2"]}], ")"}]}], "+", 
     RowBox[{
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{
        FractionBox["1", "2"], " ", 
        RowBox[{"(", 
         RowBox[{"a", "+", "L"}], ")"}], " ", "s"}]], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", 
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{"2", " ", "\[ImaginaryI]", " ", "a", " ", "k"}]]}], ")"}], 
      " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", 
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{"2", " ", "\[ImaginaryI]", " ", "k", " ", "L"}]]}], ")"}], 
      " ", 
      SuperscriptBox["L", "2"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"4", " ", 
         SuperscriptBox["k", "2"]}], "+", 
        SuperscriptBox["s", "2"]}], ")"}]}], "+", 
     RowBox[{"2", " ", "a", " ", "g", " ", "L", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"8", " ", 
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{"\[ImaginaryI]", " ", "k", " ", 
           RowBox[{"(", 
            RowBox[{"a", "+", "L"}], ")"}]}]], " ", 
         SuperscriptBox["k", "2"]}], "+", 
        RowBox[{"8", " ", 
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"a", "+", "L"}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"\[ImaginaryI]", " ", "k"}], "+", "s"}], ")"}]}]], " ", 
         SuperscriptBox["k", "2"]}], "+", 
        RowBox[{
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{
           FractionBox["1", "2"], " ", 
           RowBox[{"(", 
            RowBox[{"a", "+", "L"}], ")"}], " ", "s"}]], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "4"}], " ", 
            SuperscriptBox["k", "2"]}], "+", 
           SuperscriptBox["s", "2"]}], ")"}]}], "+", 
        RowBox[{
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{
           FractionBox["1", "2"], " ", 
           RowBox[{"(", 
            RowBox[{"a", "+", "L"}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"4", " ", "\[ImaginaryI]", " ", "k"}], "+", "s"}], 
            ")"}]}]], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "4"}], " ", 
            SuperscriptBox["k", "2"]}], "+", 
           SuperscriptBox["s", "2"]}], ")"}]}], "-", 
        RowBox[{
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{
           RowBox[{"2", " ", "\[ImaginaryI]", " ", "a", " ", "k"}], "+", 
           RowBox[{
            FractionBox["1", "2"], " ", 
            RowBox[{"(", 
             RowBox[{"a", "+", "L"}], ")"}], " ", "s"}]}]], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"4", " ", 
            SuperscriptBox["k", "2"]}], "+", 
           SuperscriptBox["s", "2"]}], ")"}]}], "-", 
        RowBox[{
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{
           RowBox[{"2", " ", "\[ImaginaryI]", " ", "k", " ", "L"}], "+", 
           RowBox[{
            FractionBox["1", "2"], " ", 
            RowBox[{"(", 
             RowBox[{"a", "+", "L"}], ")"}], " ", "s"}]}]], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"4", " ", 
            SuperscriptBox["k", "2"]}], "+", 
           SuperscriptBox["s", "2"]}], ")"}]}]}], ")"}]}]}], 
    ")"}]}]}]], "Output",
 CellChangeTimes->{
  3.653553286334795*^9, {3.653554382948423*^9, 3.6535543973156347`*^9}, 
   3.653554870574215*^9, 3.653558334603322*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ExpToTrig", "[", "%29", "]"}]], "Input",
 NumberMarks->False],

Cell[BoxData[
 RowBox[{
  FractionBox["1", 
   RowBox[{"16", " ", "a", " ", "g", " ", 
    SuperscriptBox["k", "2"], " ", "L"}]], 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Cos", "[", 
      RowBox[{"k", " ", 
       RowBox[{"(", 
        RowBox[{"a", "+", "L"}], ")"}]}], "]"}], "-", 
     RowBox[{"\[ImaginaryI]", " ", 
      RowBox[{"Sin", "[", 
       RowBox[{"k", " ", 
        RowBox[{"(", 
         RowBox[{"a", "+", "L"}], ")"}]}], "]"}]}]}], ")"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      SuperscriptBox["a", "2"], " ", 
      SuperscriptBox["g", "2"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"4", " ", 
         SuperscriptBox["k", "2"]}], "+", 
        SuperscriptBox["s", "2"]}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", 
        RowBox[{"Cos", "[", 
         RowBox[{"2", " ", "a", " ", "k"}], "]"}], "+", 
        RowBox[{"\[ImaginaryI]", " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"2", " ", "a", " ", "k"}], "]"}]}]}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", 
        RowBox[{"Cos", "[", 
         RowBox[{"2", " ", "k", " ", "L"}], "]"}], "+", 
        RowBox[{"\[ImaginaryI]", " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"2", " ", "k", " ", "L"}], "]"}]}]}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Cosh", "[", 
         RowBox[{
          FractionBox["1", "2"], " ", 
          RowBox[{"(", 
           RowBox[{"a", "+", "L"}], ")"}], " ", "s"}], "]"}], "+", 
        RowBox[{"Sinh", "[", 
         RowBox[{
          FractionBox["1", "2"], " ", 
          RowBox[{"(", 
           RowBox[{"a", "+", "L"}], ")"}], " ", "s"}], "]"}]}], ")"}]}], "+", 
     
     RowBox[{
      SuperscriptBox["L", "2"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"4", " ", 
         SuperscriptBox["k", "2"]}], "+", 
        SuperscriptBox["s", "2"]}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", 
        RowBox[{"Cos", "[", 
         RowBox[{"2", " ", "a", " ", "k"}], "]"}], "+", 
        RowBox[{"\[ImaginaryI]", " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"2", " ", "a", " ", "k"}], "]"}]}]}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", 
        RowBox[{"Cos", "[", 
         RowBox[{"2", " ", "k", " ", "L"}], "]"}], "+", 
        RowBox[{"\[ImaginaryI]", " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"2", " ", "k", " ", "L"}], "]"}]}]}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Cosh", "[", 
         RowBox[{
          FractionBox["1", "2"], " ", 
          RowBox[{"(", 
           RowBox[{"a", "+", "L"}], ")"}], " ", "s"}], "]"}], "+", 
        RowBox[{"Sinh", "[", 
         RowBox[{
          FractionBox["1", "2"], " ", 
          RowBox[{"(", 
           RowBox[{"a", "+", "L"}], ")"}], " ", "s"}], "]"}]}], ")"}]}], "+", 
     
     RowBox[{"2", " ", "a", " ", "g", " ", "L", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"8", " ", 
         SuperscriptBox["k", "2"], " ", 
         RowBox[{"Cos", "[", 
          RowBox[{"k", " ", 
           RowBox[{"(", 
            RowBox[{"a", "+", "L"}], ")"}]}], "]"}]}], "+", 
        RowBox[{"8", " ", 
         SuperscriptBox["k", "2"], " ", 
         RowBox[{"Cosh", "[", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"a", "+", "L"}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"\[ImaginaryI]", " ", "k"}], "+", "s"}], ")"}]}], 
          "]"}]}], "+", 
        RowBox[{"8", " ", "\[ImaginaryI]", " ", 
         SuperscriptBox["k", "2"], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"k", " ", 
           RowBox[{"(", 
            RowBox[{"a", "+", "L"}], ")"}]}], "]"}]}], "-", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"4", " ", 
            SuperscriptBox["k", "2"]}], "+", 
           SuperscriptBox["s", "2"]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Cos", "[", 
            RowBox[{
             RowBox[{"2", " ", "a", " ", "k"}], "-", 
             FractionBox[
              RowBox[{"\[ImaginaryI]", " ", "a", " ", "s"}], "2"], "-", 
             FractionBox[
              RowBox[{"\[ImaginaryI]", " ", "L", " ", "s"}], "2"]}], "]"}], 
           "+", 
           RowBox[{"\[ImaginaryI]", " ", 
            RowBox[{"Sin", "[", 
             RowBox[{
              RowBox[{"2", " ", "a", " ", "k"}], "-", 
              FractionBox[
               RowBox[{"\[ImaginaryI]", " ", "a", " ", "s"}], "2"], "-", 
              FractionBox[
               RowBox[{"\[ImaginaryI]", " ", "L", " ", "s"}], "2"]}], 
             "]"}]}]}], ")"}]}], "-", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"4", " ", 
            SuperscriptBox["k", "2"]}], "+", 
           SuperscriptBox["s", "2"]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Cos", "[", 
            RowBox[{
             RowBox[{"2", " ", "k", " ", "L"}], "-", 
             FractionBox[
              RowBox[{"\[ImaginaryI]", " ", "a", " ", "s"}], "2"], "-", 
             FractionBox[
              RowBox[{"\[ImaginaryI]", " ", "L", " ", "s"}], "2"]}], "]"}], 
           "+", 
           RowBox[{"\[ImaginaryI]", " ", 
            RowBox[{"Sin", "[", 
             RowBox[{
              RowBox[{"2", " ", "k", " ", "L"}], "-", 
              FractionBox[
               RowBox[{"\[ImaginaryI]", " ", "a", " ", "s"}], "2"], "-", 
              FractionBox[
               RowBox[{"\[ImaginaryI]", " ", "L", " ", "s"}], "2"]}], 
             "]"}]}]}], ")"}]}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "4"}], " ", 
            SuperscriptBox["k", "2"]}], "+", 
           SuperscriptBox["s", "2"]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Cosh", "[", 
            RowBox[{
             FractionBox["1", "2"], " ", 
             RowBox[{"(", 
              RowBox[{"a", "+", "L"}], ")"}], " ", "s"}], "]"}], "+", 
           RowBox[{"Sinh", "[", 
            RowBox[{
             FractionBox["1", "2"], " ", 
             RowBox[{"(", 
              RowBox[{"a", "+", "L"}], ")"}], " ", "s"}], "]"}]}], ")"}]}], 
        "+", 
        RowBox[{"8", " ", 
         SuperscriptBox["k", "2"], " ", 
         RowBox[{"Sinh", "[", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"a", "+", "L"}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"\[ImaginaryI]", " ", "k"}], "+", "s"}], ")"}]}], 
          "]"}]}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "4"}], " ", 
            SuperscriptBox["k", "2"]}], "+", 
           SuperscriptBox["s", "2"]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Cosh", "[", 
            RowBox[{
             FractionBox["1", "2"], " ", 
             RowBox[{"(", 
              RowBox[{"a", "+", "L"}], ")"}], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"4", " ", "\[ImaginaryI]", " ", "k"}], "+", "s"}], 
              ")"}]}], "]"}], "+", 
           RowBox[{"Sinh", "[", 
            RowBox[{
             FractionBox["1", "2"], " ", 
             RowBox[{"(", 
              RowBox[{"a", "+", "L"}], ")"}], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"4", " ", "\[ImaginaryI]", " ", "k"}], "+", "s"}], 
              ")"}]}], "]"}]}], ")"}]}]}], ")"}]}]}], ")"}]}]}]], "Output",
 CellChangeTimes->{3.653558347006032*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"FullSimplify", "[", "%30", "]"}]], "Input",
 NumberMarks->False],

Cell[BoxData[
 RowBox[{
  FractionBox["1", 
   RowBox[{"16", " ", "a", " ", "g", " ", 
    SuperscriptBox["k", "2"], " ", "L"}]], 
  RowBox[{
   SuperscriptBox["\[ExponentialE]", 
    RowBox[{
     RowBox[{"-", "\[ImaginaryI]"}], " ", "k", " ", 
     RowBox[{"(", 
      RowBox[{"a", "+", "L"}], ")"}]}]], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      SuperscriptBox["a", "2"], " ", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{
        FractionBox["1", "2"], " ", 
        RowBox[{"(", 
         RowBox[{"a", "+", "L"}], ")"}], " ", "s"}]], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", 
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{"2", " ", "\[ImaginaryI]", " ", "a", " ", "k"}]]}], ")"}], 
      " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", 
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{"2", " ", "\[ImaginaryI]", " ", "k", " ", "L"}]]}], ")"}], 
      " ", 
      SuperscriptBox["g", "2"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"4", " ", 
         SuperscriptBox["k", "2"]}], "+", 
        SuperscriptBox["s", "2"]}], ")"}]}], "+", 
     RowBox[{
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{
        FractionBox["1", "2"], " ", 
        RowBox[{"(", 
         RowBox[{"a", "+", "L"}], ")"}], " ", "s"}]], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", 
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{"2", " ", "\[ImaginaryI]", " ", "a", " ", "k"}]]}], ")"}], 
      " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", 
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{"2", " ", "\[ImaginaryI]", " ", "k", " ", "L"}]]}], ")"}], 
      " ", 
      SuperscriptBox["L", "2"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"4", " ", 
         SuperscriptBox["k", "2"]}], "+", 
        SuperscriptBox["s", "2"]}], ")"}]}], "+", 
     RowBox[{"2", " ", "a", " ", "g", " ", "L", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"8", " ", 
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{"\[ImaginaryI]", " ", "k", " ", 
           RowBox[{"(", 
            RowBox[{"a", "+", "L"}], ")"}]}]], " ", 
         SuperscriptBox["k", "2"]}], "+", 
        RowBox[{"8", " ", 
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"a", "+", "L"}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"\[ImaginaryI]", " ", "k"}], "+", "s"}], ")"}]}]], " ", 
         SuperscriptBox["k", "2"]}], "+", 
        RowBox[{
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{
           FractionBox["1", "2"], " ", 
           RowBox[{"(", 
            RowBox[{"a", "+", "L"}], ")"}], " ", "s"}]], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "4"}], " ", 
            SuperscriptBox["k", "2"]}], "+", 
           SuperscriptBox["s", "2"]}], ")"}]}], "+", 
        RowBox[{
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{
           FractionBox["1", "2"], " ", 
           RowBox[{"(", 
            RowBox[{"a", "+", "L"}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"4", " ", "\[ImaginaryI]", " ", "k"}], "+", "s"}], 
            ")"}]}]], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "4"}], " ", 
            SuperscriptBox["k", "2"]}], "+", 
           SuperscriptBox["s", "2"]}], ")"}]}], "-", 
        RowBox[{
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{
           RowBox[{"2", " ", "\[ImaginaryI]", " ", "a", " ", "k"}], "+", 
           RowBox[{
            FractionBox["1", "2"], " ", 
            RowBox[{"(", 
             RowBox[{"a", "+", "L"}], ")"}], " ", "s"}]}]], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"4", " ", 
            SuperscriptBox["k", "2"]}], "+", 
           SuperscriptBox["s", "2"]}], ")"}]}], "-", 
        RowBox[{
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{
           RowBox[{"2", " ", "\[ImaginaryI]", " ", "k", " ", "L"}], "+", 
           RowBox[{
            FractionBox["1", "2"], " ", 
            RowBox[{"(", 
             RowBox[{"a", "+", "L"}], ")"}], " ", "s"}]}]], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"4", " ", 
            SuperscriptBox["k", "2"]}], "+", 
           SuperscriptBox["s", "2"]}], ")"}]}]}], ")"}]}]}], 
    ")"}]}]}]], "Output",
 CellChangeTimes->{3.653558357455105*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Normal", "[", "%19", "]"}]], "Input",
 NumberMarks->False],

Cell[BoxData[
 RowBox[{
  RowBox[{
   FractionBox["1", 
    RowBox[{"16", " ", "g", " ", "k"}]], 
   RowBox[{"a", " ", "s", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"16", " ", 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{
         RowBox[{"\[ImaginaryI]", " ", "L", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "k"}], "-", 
            FractionBox[
             RowBox[{"\[ImaginaryI]", " ", "s"}], "2"]}], ")"}]}], "+", 
         RowBox[{"\[ImaginaryI]", " ", "L", " ", 
          RowBox[{"(", 
           RowBox[{"k", "-", 
            FractionBox[
             RowBox[{"\[ImaginaryI]", " ", "s"}], "2"]}], ")"}]}]}]], " ", 
       "g", " ", "k"}], "-", 
      RowBox[{"8", " ", 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"\[ImaginaryI]", " ", "L", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "k"}], "-", 
           FractionBox[
            RowBox[{"\[ImaginaryI]", " ", "s"}], "2"]}], ")"}]}]], " ", "g", 
       " ", "k"}], "-", 
      RowBox[{"8", " ", 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"\[ImaginaryI]", " ", "L", " ", 
         RowBox[{"(", 
          RowBox[{"k", "-", 
           FractionBox[
            RowBox[{"\[ImaginaryI]", " ", "s"}], "2"]}], ")"}]}]], " ", "g", 
       " ", "k"}], "-", 
      RowBox[{"4", " ", "\[ImaginaryI]", " ", 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"\[ImaginaryI]", " ", "L", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "k"}], "-", 
           FractionBox[
            RowBox[{"\[ImaginaryI]", " ", "s"}], "2"]}], ")"}]}]], " ", 
       SuperscriptBox["k", "2"], " ", "L"}], "+", 
      RowBox[{"4", " ", "\[ImaginaryI]", " ", 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"\[ImaginaryI]", " ", "L", " ", 
         RowBox[{"(", 
          RowBox[{"k", "-", 
           FractionBox[
            RowBox[{"\[ImaginaryI]", " ", "s"}], "2"]}], ")"}]}]], " ", 
       SuperscriptBox["k", "2"], " ", "L"}], "-", 
      RowBox[{"4", " ", "\[ImaginaryI]", " ", 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"\[ImaginaryI]", " ", "L", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "k"}], "-", 
           FractionBox[
            RowBox[{"\[ImaginaryI]", " ", "s"}], "2"]}], ")"}]}]], " ", "g", 
       " ", "s"}], "+", 
      RowBox[{"4", " ", "\[ImaginaryI]", " ", 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"\[ImaginaryI]", " ", "L", " ", 
         RowBox[{"(", 
          RowBox[{"k", "-", 
           FractionBox[
            RowBox[{"\[ImaginaryI]", " ", "s"}], "2"]}], ")"}]}]], " ", "g", 
       " ", "s"}], "-", 
      RowBox[{"\[ImaginaryI]", " ", 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"\[ImaginaryI]", " ", "L", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "k"}], "-", 
           FractionBox[
            RowBox[{"\[ImaginaryI]", " ", "s"}], "2"]}], ")"}]}]], " ", "L", 
       " ", 
       SuperscriptBox["s", "2"]}], "+", 
      RowBox[{"\[ImaginaryI]", " ", 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"\[ImaginaryI]", " ", "L", " ", 
         RowBox[{"(", 
          RowBox[{"k", "-", 
           FractionBox[
            RowBox[{"\[ImaginaryI]", " ", "s"}], "2"]}], ")"}]}]], " ", "L", 
       " ", 
       SuperscriptBox["s", "2"]}]}], ")"}]}]}], "+", 
  RowBox[{
   FractionBox["1", 
    RowBox[{"256", " ", 
     SuperscriptBox["g", "2"], " ", 
     SuperscriptBox["k", "4"], " ", 
     SuperscriptBox["L", "2"]}]], 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "4"}], " ", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{
        RowBox[{"\[ImaginaryI]", " ", "L", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "k"}], "-", 
           FractionBox[
            RowBox[{"\[ImaginaryI]", " ", "s"}], "2"]}], ")"}]}], "+", 
        RowBox[{"\[ImaginaryI]", " ", "L", " ", 
         RowBox[{"(", 
          RowBox[{"k", "-", 
           FractionBox[
            RowBox[{"\[ImaginaryI]", " ", "s"}], "2"]}], ")"}]}]}]], " ", 
      SuperscriptBox["k", "2"], " ", 
      SuperscriptBox["L", "4"], " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         RowBox[{"4", " ", 
          SuperscriptBox["k", "2"]}], "+", 
         SuperscriptBox["s", "2"]}], ")"}], "2"]}], "+", 
     RowBox[{"256", " ", 
      SuperscriptBox["g", "2"], " ", 
      SuperscriptBox["k", "4"], " ", 
      SuperscriptBox["L", "2"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", 
        FractionBox[
         RowBox[{
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{"\[ImaginaryI]", " ", "L", " ", 
            RowBox[{"(", 
             RowBox[{"k", "-", 
              FractionBox[
               RowBox[{"\[ImaginaryI]", " ", "s"}], "2"]}], ")"}]}]], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"8", " ", "g", " ", "k"}], "-", 
            RowBox[{"4", " ", "\[ImaginaryI]", " ", 
             SuperscriptBox["k", "2"], " ", "L"}], "-", 
            RowBox[{"\[ImaginaryI]", " ", "L", " ", 
             SuperscriptBox["s", "2"]}]}], ")"}]}], 
         RowBox[{"8", " ", "g", " ", "k"}]]}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", 
        FractionBox[
         RowBox[{
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{"\[ImaginaryI]", " ", "L", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "k"}], "-", 
              FractionBox[
               RowBox[{"\[ImaginaryI]", " ", "s"}], "2"]}], ")"}]}]], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"8", " ", "g", " ", "k"}], "+", 
            RowBox[{"4", " ", "\[ImaginaryI]", " ", 
             SuperscriptBox["k", "2"], " ", "L"}], "+", 
            RowBox[{"\[ImaginaryI]", " ", "L", " ", 
             SuperscriptBox["s", "2"]}]}], ")"}]}], 
         RowBox[{"8", " ", "g", " ", "k"}]]}], ")"}]}]}], ")"}]}]}]], "Output",\

 CellChangeTimes->{3.6535548779022017`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"FullSimplify", "[", 
  FractionBox[
   RowBox[{
    RowBox[{"8", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{
         FractionBox["1", "2"], " ", "L", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "2"}], " ", "\[ImaginaryI]", " ", "k"}], "+", "s"}], 
          ")"}]}]]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{
         FractionBox["1", "2"], " ", "L", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", " ", "\[ImaginaryI]", " ", "k"}], "+", "s"}], 
          ")"}]}]]}], ")"}], " ", "g", " ", "k"}], "+", 
    RowBox[{"\[ImaginaryI]", " ", 
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{
       FractionBox["1", "2"], " ", "L", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "2"}], " ", "\[ImaginaryI]", " ", "k"}], "+", "s"}], 
        ")"}]}]], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"2", " ", "\[ImaginaryI]", " ", "k", " ", "L"}]]}], ")"}], 
     " ", "L", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"4", " ", 
        SuperscriptBox["k", "2"]}], "+", 
       SuperscriptBox["s", "2"]}], ")"}]}]}], 
   RowBox[{"8", " ", "g", " ", "k"}]], "]"}]], "Input",
 NumberMarks->False],

Cell[BoxData[
 RowBox[{"-", 
  FractionBox[
   RowBox[{
    SuperscriptBox["\[ExponentialE]", 
     FractionBox[
      RowBox[{"L", " ", "s"}], "2"]], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"8", " ", "g", " ", "k", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Cos", "[", 
          RowBox[{"k", " ", "L"}], "]"}], "-", 
         RowBox[{"Cosh", "[", 
          FractionBox[
           RowBox[{"L", " ", "s"}], "2"], "]"}]}], ")"}]}], "+", 
      RowBox[{"L", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"4", " ", 
          SuperscriptBox["k", "2"]}], "+", 
         SuperscriptBox["s", "2"]}], ")"}], " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"k", " ", "L"}], "]"}]}]}], ")"}]}], 
   RowBox[{"4", " ", "g", " ", "k"}]]}]], "Output",
 CellChangeTimes->{3.6535544013943*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"Assuming", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"g", ">", "0"}], ",", 
     RowBox[{"k", ">", "0"}]}], "}"}], ",", 
   RowBox[{"FullSimplify", "[", 
    FractionBox[
     RowBox[{
      RowBox[{"16", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", 
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{
           FractionBox["1", "2"], " ", "L", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "2"}], " ", "\[ImaginaryI]", " ", "k"}], "+", 
             "s"}], ")"}]}]]}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", 
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{
           FractionBox["1", "2"], " ", "L", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"2", " ", "\[ImaginaryI]", " ", "k"}], "+", "s"}], 
            ")"}]}]]}], ")"}], " ", "g", " ", "k"}], "+", 
      RowBox[{"\[ImaginaryI]", " ", 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{
         FractionBox["1", "2"], " ", "L", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "2"}], " ", "\[ImaginaryI]", " ", "k"}], "+", "s"}], 
          ")"}]}]], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", 
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{"2", " ", "\[ImaginaryI]", " ", "k", " ", "L"}]]}], ")"}], 
       " ", "L", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"4", " ", 
          SuperscriptBox["k", "2"]}], "+", 
         SuperscriptBox["s", "2"]}], ")"}]}]}], 
     RowBox[{"16", " ", "g", " ", "k"}]], "]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.653553313037825*^9, 3.653553333311576*^9}},
 NumberMarks->False],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   FractionBox[
    RowBox[{
     SuperscriptBox["\[ExponentialE]", 
      FractionBox[
       RowBox[{"L", " ", "s"}], "2"]], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"16", " ", "g", " ", "k", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Cos", "[", 
           RowBox[{"k", " ", "L"}], "]"}], "-", 
          RowBox[{"Cosh", "[", 
           FractionBox[
            RowBox[{"L", " ", "s"}], "2"], "]"}]}], ")"}]}], "+", 
       RowBox[{"L", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"4", " ", 
           SuperscriptBox["k", "2"]}], "+", 
          SuperscriptBox["s", "2"]}], ")"}], " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"k", " ", "L"}], "]"}]}]}], ")"}]}], 
    RowBox[{"8", " ", "g", " ", "k"}]]}], "/.", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"k", "\[Rule]", 
     RowBox[{"q", "/", "L"}]}], ",", 
    RowBox[{"s", "\[Rule]", 
     RowBox[{"S", "/", "L"}]}]}], "}"}]}]], "Input",
 CellChangeTimes->{{3.65355338577946*^9, 3.65355339670242*^9}}],

Cell[BoxData[
 RowBox[{"-", 
  FractionBox[
   RowBox[{
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{"S", "/", "2"}]], " ", "L", " ", 
    RowBox[{"(", 
     RowBox[{
      FractionBox[
       RowBox[{"16", " ", "g", " ", "q", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Cos", "[", "q", "]"}], "-", 
          RowBox[{"Cosh", "[", 
           FractionBox["S", "2"], "]"}]}], ")"}]}], "L"], "+", 
      RowBox[{"L", " ", 
       RowBox[{"(", 
        RowBox[{
         FractionBox[
          RowBox[{"4", " ", 
           SuperscriptBox["q", "2"]}], 
          SuperscriptBox["L", "2"]], "+", 
         FractionBox[
          SuperscriptBox["S", "2"], 
          SuperscriptBox["L", "2"]]}], ")"}], " ", 
       RowBox[{"Sin", "[", "q", "]"}]}]}], ")"}]}], 
   RowBox[{"8", " ", "g", " ", "q"}]]}]], "Output",
 CellChangeTimes->{{3.6535534118984537`*^9, 3.653553420798554*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"FullSimplify", "[", 
  RowBox[{
   RowBox[{"-", 
    FractionBox[
     RowBox[{
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"S", "/", "2"}]], " ", "L", " ", 
      RowBox[{"(", 
       RowBox[{
        FractionBox[
         RowBox[{"16", " ", "g", " ", "q", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Cos", "[", "q", "]"}], "-", 
            RowBox[{"Cosh", "[", 
             FractionBox["S", "2"], "]"}]}], ")"}]}], "L"], "+", 
        RowBox[{"L", " ", 
         RowBox[{"(", 
          RowBox[{
           FractionBox[
            RowBox[{"4", " ", 
             SuperscriptBox["q", "2"]}], 
            SuperscriptBox["L", "2"]], "+", 
           FractionBox[
            SuperscriptBox["S", "2"], 
            SuperscriptBox["L", "2"]]}], ")"}], " ", 
         RowBox[{"Sin", "[", "q", "]"}]}]}], ")"}]}], 
     RowBox[{"8", " ", "g", " ", "q"}]]}], "\[Equal]", "0"}], "]"}]], "Input",\

 CellChangeTimes->{{3.653553439984664*^9, 3.653553440336277*^9}},
 NumberMarks->False],

Cell[BoxData[
 RowBox[{
  FractionBox[
   RowBox[{
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{"S", "/", "2"}]], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"16", " ", "g", " ", "q", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Cos", "[", "q", "]"}], "-", 
         RowBox[{"Cosh", "[", 
          FractionBox["S", "2"], "]"}]}], ")"}]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"4", " ", 
          SuperscriptBox["q", "2"]}], "+", 
         SuperscriptBox["S", "2"]}], ")"}], " ", 
       RowBox[{"Sin", "[", "q", "]"}]}]}], ")"}]}], 
   RowBox[{"g", " ", "q"}]], "\[Equal]", "0"}]], "Output",
 CellChangeTimes->{{3.653553425622581*^9, 3.653553441300515*^9}}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"FullSimplify", "[", "%27", "]"}]], "Input",
 NumberMarks->False],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"16", "  ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Cos", "[", "q", "]"}], "-", "1"}], ")"}]}], "+", 
  FractionBox[
   RowBox[{"(", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"4", " ", 
        SuperscriptBox["q", "2"]}], "+", 
       SuperscriptBox["S", "2"]}], ")"}], " ", 
     RowBox[{"Sin", "[", "q", "]"}]}], ")"}], 
   RowBox[{"g", " ", "q"}]]}]], "Input",
 CellChangeTimes->{{3.653553736476079*^9, 3.653553747887765*^9}, {
  3.653553881057971*^9, 3.6535538963796453`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"16", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "1"}], "+", 
     RowBox[{"Cos", "[", "q", "]"}]}], ")"}]}], "+", 
  FractionBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"4", " ", 
       SuperscriptBox["q", "2"]}], "+", 
      SuperscriptBox["S", "2"]}], ")"}], " ", 
    RowBox[{"Sin", "[", "q", "]"}]}], 
   RowBox[{"g", " ", "q"}]]}]], "Output",
 CellChangeTimes->{3.653553909405076*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"FullSimplify", "[", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"16", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", 
        RowBox[{"Cos", "[", "q", "]"}]}], ")"}]}], "+", 
     FractionBox[
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"4", " ", 
          SuperscriptBox["q", "2"]}], "+", 
         SuperscriptBox["S", "2"]}], ")"}], " ", 
       RowBox[{"Sin", "[", "q", "]"}]}], 
      RowBox[{"g", " ", "q"}]]}], ")"}], "/", "16"}], "]"}]], "Input",
 CellChangeTimes->{{3.653553923456552*^9, 3.653553939822555*^9}},
 NumberMarks->False],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Series", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"-", "1"}], "+", 
    RowBox[{"Cos", "[", "q", "]"}], "+", 
    FractionBox[
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"4", " ", 
         SuperscriptBox["q", "2"]}], "+", 
        SuperscriptBox["S", "2"]}], ")"}], " ", 
      RowBox[{"Sin", "[", "q", "]"}]}], 
     RowBox[{"16", " ", "g", " ", "q"}]]}], ",", 
   RowBox[{"{", 
    RowBox[{"q", ",", 
     RowBox[{"\[ImaginaryI]", "*", 
      RowBox[{"S", "/", "2"}]}], ",", "2"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.6535539655252*^9, 3.6535539776936817`*^9}}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "1"}], "+", 
     RowBox[{"Cosh", "[", 
      FractionBox["S", "2"], "]"}]}], ")"}], "-", 
   FractionBox[
    RowBox[{"\[ImaginaryI]", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", 
       RowBox[{"2", " ", "g"}]}], ")"}], " ", 
     RowBox[{"Sinh", "[", 
      FractionBox["S", "2"], "]"}], " ", 
     RowBox[{"(", 
      RowBox[{"q", "-", 
       FractionBox[
        RowBox[{"\[ImaginaryI]", " ", "S"}], "2"]}], ")"}]}], 
    RowBox[{"2", " ", "g"}]], "+", 
   FractionBox[
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"S", " ", 
        RowBox[{"Cosh", "[", 
         FractionBox["S", "2"], "]"}]}], "-", 
       RowBox[{"g", " ", "S", " ", 
        RowBox[{"Cosh", "[", 
         FractionBox["S", "2"], "]"}]}], "-", 
       RowBox[{"Sinh", "[", 
        FractionBox["S", "2"], "]"}]}], ")"}], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"q", "-", 
        FractionBox[
         RowBox[{"\[ImaginaryI]", " ", "S"}], "2"]}], ")"}], "2"]}], 
    RowBox[{"2", " ", "g", " ", "S"}]], "+", 
   InterpretationBox[
    SuperscriptBox[
     RowBox[{"O", "[", 
      RowBox[{"q", "-", 
       FractionBox[
        RowBox[{"\[ImaginaryI]", " ", "S"}], "2"]}], "]"}], "3"],
    SeriesData[$CellContext`q, Complex[0, 
       Rational[1, 2]] $CellContext`S, {}, 0, 3, 1],
    Editable->False]}],
  SeriesData[$CellContext`q, Complex[0, 
     Rational[1, 2]] $CellContext`S, {-1 + 
    Cosh[Rational[1, 2] $CellContext`S], Complex[0, 
      Rational[-1, 2]] $CellContext`g^(-1) (-1 + 2 $CellContext`g) 
    Sinh[Rational[1, 2] $CellContext`S], 
    Rational[1, 2] $CellContext`g^(-1) $CellContext`S^(-1) ($CellContext`S 
      Cosh[Rational[1, 2] $CellContext`S] - $CellContext`g $CellContext`S 
     Cosh[Rational[1, 2] $CellContext`S] - Sinh[
     Rational[1, 2] $CellContext`S])}, 0, 3, 1],
  Editable->False]], "Output",
 CellChangeTimes->{3.6535539780542192`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Normal", "[", 
  InterpretationBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", 
      RowBox[{"Cosh", "[", 
       FractionBox["S", "2"], "]"}]}], ")"}], "-", 
    FractionBox[
     RowBox[{"\[ImaginaryI]", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", 
        RowBox[{"2", " ", "g"}]}], ")"}], " ", 
      RowBox[{"Sinh", "[", 
       FractionBox["S", "2"], "]"}], " ", 
      RowBox[{"(", 
       RowBox[{"q", "-", 
        FractionBox[
         RowBox[{"\[ImaginaryI]", " ", "S"}], "2"]}], ")"}]}], 
     RowBox[{"2", " ", "g"}]], "+", 
    FractionBox[
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"S", " ", 
         RowBox[{"Cosh", "[", 
          FractionBox["S", "2"], "]"}]}], "-", 
        RowBox[{"g", " ", "S", " ", 
         RowBox[{"Cosh", "[", 
          FractionBox["S", "2"], "]"}]}], "-", 
        RowBox[{"Sinh", "[", 
         FractionBox["S", "2"], "]"}]}], ")"}], " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"q", "-", 
         FractionBox[
          RowBox[{"\[ImaginaryI]", " ", "S"}], "2"]}], ")"}], "2"]}], 
     RowBox[{"2", " ", "g", " ", "S"}]], "+", 
    InterpretationBox[
     SuperscriptBox[
      RowBox[{"O", "[", 
       RowBox[{"q", "-", 
        FractionBox[
         RowBox[{"\[ImaginaryI]", " ", "S"}], "2"]}], "]"}], "3"],
     SeriesData[$CellContext`q, Complex[0, 
        Rational[1, 2]] $CellContext`S, {}, 0, 3, 1],
     Editable->False]}],
   SeriesData[$CellContext`q, Complex[0, 
      Rational[1, 2]] $CellContext`S, {-1 + 
     Cosh[Rational[1, 2] $CellContext`S], Complex[0, 
       Rational[-1, 2]] $CellContext`g^(-1) (-1 + 2 $CellContext`g) 
     Sinh[Rational[1, 2] $CellContext`S], 
     Rational[1, 2] $CellContext`g^(-1) $CellContext`S^(-1) ($CellContext`S 
       Cosh[Rational[1, 2] $CellContext`S] - $CellContext`g $CellContext`S 
      Cosh[Rational[1, 2] $CellContext`S] - Sinh[
      Rational[1, 2] $CellContext`S])}, 0, 3, 1],
   Editable->False], "]"}]], "Input",
 NumberMarks->False],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", "1"}], "+", 
  RowBox[{"Cosh", "[", 
   FractionBox["S", "2"], "]"}], "+", 
  FractionBox[
   RowBox[{
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"q", "-", 
       FractionBox[
        RowBox[{"\[ImaginaryI]", " ", "S"}], "2"]}], ")"}], "2"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"S", " ", 
       RowBox[{"Cosh", "[", 
        FractionBox["S", "2"], "]"}]}], "-", 
      RowBox[{"g", " ", "S", " ", 
       RowBox[{"Cosh", "[", 
        FractionBox["S", "2"], "]"}]}], "-", 
      RowBox[{"Sinh", "[", 
       FractionBox["S", "2"], "]"}]}], ")"}]}], 
   RowBox[{"2", " ", "g", " ", "S"}]], "-", 
  FractionBox[
   RowBox[{"\[ImaginaryI]", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", 
      RowBox[{"2", " ", "g"}]}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{"q", "-", 
      FractionBox[
       RowBox[{"\[ImaginaryI]", " ", "S"}], "2"]}], ")"}], " ", 
    RowBox[{"Sinh", "[", 
     FractionBox["S", "2"], "]"}]}], 
   RowBox[{"2", " ", "g"}]]}]], "Output",
 CellChangeTimes->{3.653553980082037*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"FullSimplify", "[", 
  RowBox[{
   RowBox[{"-", "1"}], "+", 
   RowBox[{"Cosh", "[", 
    FractionBox["S", "2"], "]"}], "+", 
   FractionBox[
    RowBox[{
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"q", "-", 
        FractionBox[
         RowBox[{"\[ImaginaryI]", " ", "S"}], "2"]}], ")"}], "2"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"S", " ", 
        RowBox[{"Cosh", "[", 
         FractionBox["S", "2"], "]"}]}], "-", 
       RowBox[{"g", " ", "S", " ", 
        RowBox[{"Cosh", "[", 
         FractionBox["S", "2"], "]"}]}], "-", 
       RowBox[{"Sinh", "[", 
        FractionBox["S", "2"], "]"}]}], ")"}]}], 
    RowBox[{"2", " ", "g", " ", "S"}]], "-", 
   FractionBox[
    RowBox[{"\[ImaginaryI]", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", 
       RowBox[{"2", " ", "g"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{"q", "-", 
       FractionBox[
        RowBox[{"\[ImaginaryI]", " ", "S"}], "2"]}], ")"}], " ", 
     RowBox[{"Sinh", "[", 
      FractionBox["S", "2"], "]"}]}], 
    RowBox[{"2", " ", "g"}]]}], "]"}]], "Input",
 NumberMarks->False],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Series", "[", 
  RowBox[{
   FractionBox[
    RowBox[{
     RowBox[{
      RowBox[{"-", "8"}], " ", "g", " ", "S"}], "+", 
     RowBox[{"S", " ", 
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", " ", "q"}], "-", 
           RowBox[{"\[ImaginaryI]", " ", "S"}]}], ")"}], "2"], "+", 
        RowBox[{"g", " ", 
         RowBox[{"(", 
          RowBox[{"8", "-", 
           RowBox[{"4", " ", 
            SuperscriptBox["q", "2"]}], "+", 
           RowBox[{"4", " ", "\[ImaginaryI]", " ", "q", " ", "S"}], "+", 
           SuperscriptBox["S", "2"]}], ")"}]}]}], ")"}], " ", 
      RowBox[{"Cosh", "[", 
       FractionBox["S", "2"], "]"}]}], "-", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"2", " ", "\[ImaginaryI]", " ", "q"}], "+", "S"}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "2"}], " ", "\[ImaginaryI]", " ", "q"}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "3"}], "+", 
           RowBox[{"4", " ", "g"}]}], ")"}], " ", "S"}]}], ")"}], " ", 
      RowBox[{"Sinh", "[", 
       FractionBox["S", "2"], "]"}]}]}], 
    RowBox[{"8", " ", "g", " ", "S"}]], ",", 
   RowBox[{"{", 
    RowBox[{"S", ",", "0", ",", "2"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.653553990749926*^9, 3.653553998789741*^9}}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
   RowBox[{"-", 
    FractionBox[
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", 
        RowBox[{"2", " ", "g"}]}], ")"}], " ", 
      SuperscriptBox["q", "2"]}], 
     RowBox[{"4", " ", "g"}]]}], "+", 
   FractionBox[
    RowBox[{
     RowBox[{"(", 
      RowBox[{"6", "+", 
       RowBox[{"5", " ", 
        SuperscriptBox["q", "2"]}], "-", 
       RowBox[{"6", " ", "g", " ", 
        SuperscriptBox["q", "2"]}]}], ")"}], " ", 
     SuperscriptBox["S", "2"]}], 
    RowBox[{"96", " ", "g"}]], "+", 
   InterpretationBox[
    SuperscriptBox[
     RowBox[{"O", "[", "S", "]"}], "3"],
    SeriesData[$CellContext`S, 0, {}, 0, 3, 1],
    Editable->False]}],
  SeriesData[$CellContext`S, 0, {
   Rational[-1, 4] $CellContext`g^(-1) (-1 + 
     2 $CellContext`g) $CellContext`q^2, 0, 
    Rational[1, 96] $CellContext`g^(-1) (6 + 5 $CellContext`q^2 - 
     6 $CellContext`g $CellContext`q^2)}, 0, 3, 1],
  Editable->False]], "Output",
 CellChangeTimes->{3.6535539991423407`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Normal", "[", 
  InterpretationBox[
   RowBox[{
    RowBox[{"-", 
     FractionBox[
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", 
         RowBox[{"2", " ", "g"}]}], ")"}], " ", 
       SuperscriptBox["q", "2"]}], 
      RowBox[{"4", " ", "g"}]]}], "+", 
    FractionBox[
     RowBox[{
      RowBox[{"(", 
       RowBox[{"6", "+", 
        RowBox[{"5", " ", 
         SuperscriptBox["q", "2"]}], "-", 
        RowBox[{"6", " ", "g", " ", 
         SuperscriptBox["q", "2"]}]}], ")"}], " ", 
      SuperscriptBox["S", "2"]}], 
     RowBox[{"96", " ", "g"}]], "+", 
    InterpretationBox[
     SuperscriptBox[
      RowBox[{"O", "[", "S", "]"}], "3"],
     SeriesData[$CellContext`S, 0, {}, 0, 3, 1],
     Editable->False]}],
   SeriesData[$CellContext`S, 0, {
    Rational[-1, 4] $CellContext`g^(-1) (-1 + 
      2 $CellContext`g) $CellContext`q^2, 0, 
     Rational[1, 96] $CellContext`g^(-1) (6 + 5 $CellContext`q^2 - 
      6 $CellContext`g $CellContext`q^2)}, 0, 3, 1],
   Editable->False], "]"}]], "Input",
 NumberMarks->False],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   FractionBox[
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", 
       RowBox[{"2", " ", "g"}]}], ")"}], " ", 
     SuperscriptBox["q", "2"]}], 
    RowBox[{"4", " ", "g"}]]}], "+", 
  FractionBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{"6", "+", 
      RowBox[{"5", " ", 
       SuperscriptBox["q", "2"]}], "-", 
      RowBox[{"6", " ", "g", " ", 
       SuperscriptBox["q", "2"]}]}], ")"}], " ", 
    SuperscriptBox["S", "2"]}], 
   RowBox[{"96", " ", "g"}]]}]], "Output",
 CellChangeTimes->{3.653554003575974*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"Simplify", "[", 
  RowBox[{
   RowBox[{"-", 
    FractionBox[
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", 
        RowBox[{"2", " ", "g"}]}], ")"}], " ", 
      SuperscriptBox["q", "2"]}], 
     RowBox[{"4", " ", "g"}]]}], "+", 
   FractionBox[
    RowBox[{
     RowBox[{"(", 
      RowBox[{"6", "+", 
       RowBox[{"5", " ", 
        SuperscriptBox["q", "2"]}], "-", 
       RowBox[{"6", " ", "g", " ", 
        SuperscriptBox["q", "2"]}]}], ")"}], " ", 
     SuperscriptBox["S", "2"]}], 
    RowBox[{"96", " ", "g"}]]}], "]"}]], "Input",
 NumberMarks->False],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Solve", "[", 
  RowBox[{
   RowBox[{
    FractionBox[
     RowBox[{
      RowBox[{"6", " ", 
       SuperscriptBox["S", "2"]}], "+", 
      RowBox[{
       SuperscriptBox["q", "2"], " ", 
       RowBox[{"(", 
        RowBox[{"24", "+", 
         RowBox[{"5", " ", 
          SuperscriptBox["S", "2"]}], "-", 
         RowBox[{"6", " ", "g", " ", 
          RowBox[{"(", 
           RowBox[{"8", "+", 
            SuperscriptBox["S", "2"]}], ")"}]}]}], ")"}]}]}], 
     RowBox[{"96", " ", "g"}]], "\[Equal]", "0"}], ",", "q"}], "]"}]], "Input",
 CellChangeTimes->{{3.653554009748582*^9, 3.6535540156289177`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"q", "\[Rule]", 
     RowBox[{"-", 
      FractionBox[
       RowBox[{
        SqrtBox["6"], " ", "S"}], 
       SqrtBox[
        RowBox[{
         RowBox[{"-", "24"}], "+", 
         RowBox[{"48", " ", "g"}], "-", 
         RowBox[{"5", " ", 
          SuperscriptBox["S", "2"]}], "+", 
         RowBox[{"6", " ", "g", " ", 
          SuperscriptBox["S", "2"]}]}]]]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"q", "\[Rule]", 
     FractionBox[
      RowBox[{
       SqrtBox["6"], " ", "S"}], 
      SqrtBox[
       RowBox[{
        RowBox[{"-", "24"}], "+", 
        RowBox[{"48", " ", "g"}], "-", 
        RowBox[{"5", " ", 
         SuperscriptBox["S", "2"]}], "+", 
        RowBox[{"6", " ", "g", " ", 
         SuperscriptBox["S", "2"]}]}]]]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.653554016041211*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Series", "[", 
  RowBox[{
   FractionBox[
    RowBox[{
     SqrtBox["6"], " ", "S"}], 
    SqrtBox[
     RowBox[{
      RowBox[{"-", "24"}], "+", 
      RowBox[{"48", " ", "g"}], "-", 
      RowBox[{"5", " ", 
       SuperscriptBox["S", "2"]}], "+", 
      RowBox[{"6", " ", "g", " ", 
       SuperscriptBox["S", "2"]}]}]]], ",", 
   RowBox[{"{", 
    RowBox[{"S", ",", "0", ",", "2"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.653554038436226*^9, 3.653554047265963*^9}}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
   FractionBox["S", 
    RowBox[{"2", " ", 
     SqrtBox[
      RowBox[{
       RowBox[{"-", "1"}], "+", 
       RowBox[{"2", " ", "g"}]}]]}]], "+", 
   InterpretationBox[
    SuperscriptBox[
     RowBox[{"O", "[", "S", "]"}], "3"],
    SeriesData[$CellContext`S, 0, {}, 1, 3, 1],
    Editable->False]}],
  SeriesData[$CellContext`S, 0, {
   Rational[1, 2] (-1 + 2 $CellContext`g)^Rational[-1, 2]}, 1, 3, 1],
  Editable->False]], "Output",
 CellChangeTimes->{3.653554072322114*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"Normal", "[", 
  InterpretationBox[
   RowBox[{
    FractionBox["S", 
     RowBox[{"2", " ", 
      SqrtBox[
       RowBox[{
        RowBox[{"-", "1"}], "+", 
        RowBox[{"2", " ", "g"}]}]]}]], "+", 
    InterpretationBox[
     SuperscriptBox[
      RowBox[{"O", "[", "S", "]"}], "3"],
     SeriesData[$CellContext`S, 0, {}, 1, 3, 1],
     Editable->False]}],
   SeriesData[$CellContext`S, 0, {
    Rational[1, 2] (-1 + 2 $CellContext`g)^Rational[-1, 2]}, 1, 3, 1],
   Editable->False], "]"}]], "Input",
 NumberMarks->False],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"(", 
    FractionBox["S", 
     RowBox[{"2", " ", 
      SqrtBox[
       RowBox[{
        RowBox[{"-", "1"}], "+", 
        RowBox[{"2", " ", "g"}]}]]}]], ")"}], "^", "2"}], "-", 
  RowBox[{
   RowBox[{"S", "^", "2"}], "/", "4"}]}]], "Input",
 CellChangeTimes->{{3.65355411636827*^9, 3.653554120001027*^9}, {
  3.653554197459326*^9, 3.653554197533016*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   FractionBox[
    SuperscriptBox["S", "2"], "4"]}], "+", 
  FractionBox[
   SuperscriptBox["S", "2"], 
   RowBox[{"4", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", 
      RowBox[{"2", " ", "g"}]}], ")"}]}]]}]], "Output",
 CellChangeTimes->{3.653554120657113*^9, 3.6535541981412687`*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"Simplify", "[", 
  RowBox[{
   RowBox[{"-", 
    FractionBox[
     SuperscriptBox["S", "2"], "4"]}], "+", 
   FractionBox[
    SuperscriptBox["S", "2"], 
    RowBox[{"4", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", 
       RowBox[{"2", " ", "g"}]}], ")"}]}]]}], "]"}]], "Input",
 NumberMarks->False],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  FractionBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "g"}], ")"}], " ", 
    SuperscriptBox["S", "2"]}], 
   RowBox[{"2", "-", 
    RowBox[{"4", " ", "g"}]}]], "/", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"S", "^", "2"}], "/", "4"}], ")"}]}]], "Input",
 CellChangeTimes->{{3.65355420464491*^9, 3.653554206972541*^9}}],

Cell[BoxData[
 FractionBox[
  RowBox[{"4", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "1"}], "+", "g"}], ")"}]}], 
  RowBox[{"2", "-", 
   RowBox[{"4", " ", "g"}]}]]], "Output",
 CellChangeTimes->{3.653554207524355*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"FullSimplify", "[", 
  FractionBox[
   RowBox[{"4", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "g"}], ")"}]}], 
   RowBox[{"2", "-", 
    RowBox[{"4", " ", "g"}]}]], "]"}]], "Input",
 NumberMarks->False],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", "1"}], "+", 
  FractionBox["1", 
   RowBox[{
    RowBox[{"-", "1"}], "+", 
    RowBox[{"2", " ", "g"}]}]]}]], "Output",
 CellChangeTimes->{3.653554208890427*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"Simplify", "[", 
  RowBox[{
   FractionBox[
    SuperscriptBox["S", "2"], "4"], "+", 
   FractionBox[
    SuperscriptBox["S", "2"], 
    RowBox[{"4", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", 
       RowBox[{"2", " ", "g"}]}], ")"}]}]]}], "]"}]], "Input",
 NumberMarks->False],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  FractionBox[
   RowBox[{"g", " ", 
    SuperscriptBox["S", "2"]}], 
   RowBox[{
    RowBox[{"-", "2"}], "+", 
    RowBox[{"4", " ", "g"}]}]], "/", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"S", "^", "2"}], "/", "4"}], ")"}]}]], "Input",
 CellChangeTimes->{{3.6535541508858356`*^9, 3.65355415722113*^9}}],

Cell[BoxData[
 FractionBox[
  RowBox[{"4", " ", "g"}], 
  RowBox[{
   RowBox[{"-", "2"}], "+", 
   RowBox[{"4", " ", "g"}]}]]], "Output",
 CellChangeTimes->{3.653554157710116*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"Normal", "[", 
  InterpretationBox[
   RowBox[{
    FractionBox["S", 
     RowBox[{"2", " ", 
      SqrtBox[
       RowBox[{
        RowBox[{"-", "1"}], "+", 
        RowBox[{"2", " ", "g"}]}]]}]], "+", 
    InterpretationBox[
     SuperscriptBox[
      RowBox[{"O", "[", "S", "]"}], "3"],
     SeriesData[$CellContext`S, 0, {}, 1, 3, 1],
     Editable->False]}],
   SeriesData[$CellContext`S, 0, {
    Rational[1, 2] (-1 + 2 $CellContext`g)^Rational[-1, 2]}, 1, 3, 1],
   Editable->False], "]"}]], "Input",
 NumberMarks->False],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Series", "[", 
  RowBox[{
   FractionBox["S", 
    RowBox[{"2", " ", 
     SqrtBox[
      RowBox[{
       RowBox[{"-", "1"}], "+", 
       RowBox[{"2", " ", "g"}]}]]}]], ",", 
   RowBox[{"{", 
    RowBox[{"g", ",", "0", ",", "1"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.65355407638237*^9, 3.653554083229982*^9}}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
   RowBox[{"-", 
    FractionBox[
     RowBox[{"\[ImaginaryI]", " ", "S"}], "2"]}], "-", 
   RowBox[{
    FractionBox["1", "2"], " ", "\[ImaginaryI]", " ", "S", " ", "g"}], "+", 
   InterpretationBox[
    SuperscriptBox[
     RowBox[{"O", "[", "g", "]"}], "2"],
    SeriesData[$CellContext`g, 0, {}, 0, 2, 1],
    Editable->False]}],
  SeriesData[$CellContext`g, 0, {Complex[0, 
      Rational[-1, 2]] $CellContext`S, Complex[0, 
      Rational[-1, 2]] $CellContext`S}, 0, 2, 1],
  Editable->False]], "Output",
 CellChangeTimes->{3.653554083619993*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"\[AliasDelimiter]", 
  InterpretationBox[
   RowBox[{
    FractionBox["S", 
     RowBox[{"2", " ", 
      SqrtBox[
       RowBox[{
        RowBox[{"-", "1"}], "+", 
        RowBox[{"2", " ", "g"}]}]]}]], "+", 
    InterpretationBox[
     SuperscriptBox[
      RowBox[{"O", "[", "S", "]"}], "3"],
     SeriesData[$CellContext`S, 0, {}, 1, 3, 1],
     Editable->False]}],
   SeriesData[$CellContext`S, 0, {
    Rational[1, 2] (-1 + 2 $CellContext`g)^Rational[-1, 2]}, 1, 3, 1],
   Editable->False]}]], "Input",
 CellChangeTimes->{{3.653554064053266*^9, 3.653554070030202*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Series", "[", 
  RowBox[{
   FractionBox[
    RowBox[{
     RowBox[{"16", " ", "g", " ", "q", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", 
        RowBox[{"Cos", "[", "q", "]"}]}], ")"}]}], "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"4", " ", 
         SuperscriptBox["q", "2"]}], "+", 
        SuperscriptBox["S", "2"]}], ")"}], " ", 
      RowBox[{"Sin", "[", "q", "]"}]}]}], 
    RowBox[{"g", " ", "q"}]], ",", 
   RowBox[{"{", 
    RowBox[{"q", ",", 
     RowBox[{"\[ImaginaryI]", "*", 
      RowBox[{"S", "/", "2"}]}], ",", "1"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.653553754065776*^9, 3.6535537649782057`*^9}}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "16"}], "+", 
     RowBox[{"16", " ", 
      RowBox[{"Cosh", "[", 
       FractionBox["S", "2"], "]"}]}]}], ")"}], "-", 
   FractionBox[
    RowBox[{"8", " ", "\[ImaginaryI]", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", 
       RowBox[{"2", " ", "g"}]}], ")"}], " ", 
     RowBox[{"Sinh", "[", 
      FractionBox["S", "2"], "]"}], " ", 
     RowBox[{"(", 
      RowBox[{"q", "-", 
       FractionBox[
        RowBox[{"\[ImaginaryI]", " ", "S"}], "2"]}], ")"}]}], "g"], "+", 
   InterpretationBox[
    SuperscriptBox[
     RowBox[{"O", "[", 
      RowBox[{"q", "-", 
       FractionBox[
        RowBox[{"\[ImaginaryI]", " ", "S"}], "2"]}], "]"}], "2"],
    SeriesData[$CellContext`q, Complex[0, 
       Rational[1, 2]] $CellContext`S, {}, 0, 2, 1],
    Editable->False]}],
  SeriesData[$CellContext`q, Complex[0, 
     Rational[1, 2]] $CellContext`S, {-16 + 
    16 Cosh[Rational[1, 2] $CellContext`S], 
    Complex[0, -8] $CellContext`g^(-1) (-1 + 2 $CellContext`g) 
    Sinh[Rational[1, 2] $CellContext`S]}, 0, 2, 1],
  Editable->False]], "Output",
 CellChangeTimes->{3.653553765677309*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"Normal", "[", 
  InterpretationBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "16"}], "+", 
      RowBox[{"16", " ", 
       RowBox[{"Cosh", "[", 
        FractionBox["S", "2"], "]"}]}]}], ")"}], "-", 
    FractionBox[
     RowBox[{"8", " ", "\[ImaginaryI]", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", 
        RowBox[{"2", " ", "g"}]}], ")"}], " ", 
      RowBox[{"Sinh", "[", 
       FractionBox["S", "2"], "]"}], " ", 
      RowBox[{"(", 
       RowBox[{"q", "-", 
        FractionBox[
         RowBox[{"\[ImaginaryI]", " ", "S"}], "2"]}], ")"}]}], "g"], "+", 
    InterpretationBox[
     SuperscriptBox[
      RowBox[{"O", "[", 
       RowBox[{"q", "-", 
        FractionBox[
         RowBox[{"\[ImaginaryI]", " ", "S"}], "2"]}], "]"}], "2"],
     SeriesData[$CellContext`q, Complex[0, 
        Rational[1, 2]] $CellContext`S, {}, 0, 2, 1],
     Editable->False]}],
   SeriesData[$CellContext`q, Complex[0, 
      Rational[1, 2]] $CellContext`S, {-16 + 
     16 Cosh[Rational[1, 2] $CellContext`S], 
     Complex[0, -8] $CellContext`g^(-1) (-1 + 2 $CellContext`g) 
     Sinh[Rational[1, 2] $CellContext`S]}, 0, 2, 1],
   Editable->False], "]"}]], "Input",
 NumberMarks->False],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Solve", "[", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"-", "16"}], "+", 
     RowBox[{"16", " ", 
      RowBox[{"Cosh", "[", 
       FractionBox["S", "2"], "]"}]}], "-", 
     FractionBox[
      RowBox[{"8", " ", "\[ImaginaryI]", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", 
         RowBox[{"2", " ", "g"}]}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{"q", "-", 
         FractionBox[
          RowBox[{"\[ImaginaryI]", " ", "S"}], "2"]}], ")"}], " ", 
       RowBox[{"Sinh", "[", 
        FractionBox["S", "2"], "]"}]}], "g"]}], "\[Equal]", "1"}], ",", "q"}],
   "]"}]], "Input",
 CellChangeTimes->{{3.653553783725663*^9, 3.653553788694449*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{"q", "\[Rule]", 
    FractionBox[
     RowBox[{"\[ImaginaryI]", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "4"}], " ", "S"}], "+", 
        RowBox[{"8", " ", "g", " ", "S"}], "-", 
        RowBox[{"16", " ", "g", " ", 
         RowBox[{"Coth", "[", 
          FractionBox["S", "2"], "]"}]}], "+", 
        RowBox[{"17", " ", "g", " ", 
         RowBox[{"Csch", "[", 
          FractionBox["S", "2"], "]"}]}]}], ")"}]}], 
     RowBox[{"8", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", 
        RowBox[{"2", " ", "g"}]}], ")"}]}]]}], "}"}], "}"}]], "Output",
 CellChangeTimes->{3.653553789097715*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Series", "[", 
  RowBox[{
   FractionBox[
    RowBox[{"\[ImaginaryI]", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "4"}], " ", "S"}], "+", 
       RowBox[{"8", " ", "g", " ", "S"}], "-", 
       RowBox[{"16", " ", "g", " ", 
        RowBox[{"Coth", "[", 
         FractionBox["S", "2"], "]"}]}], "+", 
       RowBox[{"17", " ", "g", " ", 
        RowBox[{"Csch", "[", 
         FractionBox["S", "2"], "]"}]}]}], ")"}]}], 
    RowBox[{"8", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", 
       RowBox[{"2", " ", "g"}]}], ")"}]}]], ",", 
   RowBox[{"{", 
    RowBox[{"S", ",", "0", ",", "2"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.653553807036386*^9, 3.653553815308634*^9}}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
   FractionBox[
    RowBox[{"\[ImaginaryI]", " ", "g"}], 
    RowBox[{"4", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", 
       RowBox[{"2", " ", "g"}]}], ")"}], " ", "S"}]], "+", 
   FractionBox[
    RowBox[{"\[ImaginaryI]", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "48"}], "+", 
       RowBox[{"47", " ", "g"}]}], ")"}], " ", "S"}], 
    RowBox[{"96", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", 
       RowBox[{"2", " ", "g"}]}], ")"}]}]], "+", 
   InterpretationBox[
    SuperscriptBox[
     RowBox[{"O", "[", "S", "]"}], "3"],
    SeriesData[$CellContext`S, 0, {}, -1, 3, 1],
    Editable->False]}],
  SeriesData[$CellContext`S, 0, {Complex[0, 
      Rational[1, 4]] $CellContext`g/(-1 + 2 $CellContext`g), 0, Complex[0, 
      Rational[1, 96]] (-1 + 2 $CellContext`g)^(-1) (-48 + 
     47 $CellContext`g)}, -1, 3, 1],
  Editable->False]], "Output",
 CellChangeTimes->{3.653553815770564*^9}]
}, Open  ]]
},
WindowSize->{808, 755},
WindowMargins->{{4, Automatic}, {Automatic, 4}},
FrontEndVersion->"10.0 for Mac OS X x86 (32-bit, 64-bit Kernel) (June 27, \
2014)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 4731, 141, 298, "Input"],
Cell[5314, 165, 4705, 137, 200, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[10056, 307, 85, 2, 28, "Input"],
Cell[10144, 311, 7732, 224, 346, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[17913, 540, 88, 2, 28, "Input"],
Cell[18004, 544, 4606, 135, 166, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[22647, 684, 82, 2, 28, "Input"],
Cell[22732, 688, 6109, 168, 218, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[28878, 861, 1513, 47, 69, "Input"],
Cell[30394, 910, 828, 26, 64, "Output"]
}, Open  ]],
Cell[31237, 939, 1832, 54, 100, "Input"],
Cell[CellGroupData[{
Cell[33094, 997, 1061, 33, 65, InheritFromParent],
Cell[34158, 1032, 904, 27, 73, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[35099, 1064, 1044, 31, 75, "Input"],
Cell[36146, 1097, 730, 22, 56, "Output"]
}, Open  ]],
Cell[36891, 1122, 88, 2, 28, "Input"],
Cell[CellGroupData[{
Cell[37004, 1128, 540, 17, 55, "Input"],
Cell[37547, 1147, 455, 16, 54, "Output"]
}, Open  ]],
Cell[38017, 1166, 630, 20, 57, "Input"],
Cell[CellGroupData[{
Cell[38672, 1190, 623, 19, 55, InheritFromParent],
Cell[39298, 1211, 2014, 58, 107, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[41349, 1274, 2079, 59, 111, "Input"],
Cell[43431, 1335, 1094, 36, 59, "Output"]
}, Open  ]],
Cell[44540, 1374, 1145, 37, 111, "Input"],
Cell[CellGroupData[{
Cell[45710, 1415, 1432, 42, 118, InheritFromParent],
Cell[47145, 1459, 1057, 33, 54, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[48239, 1497, 1097, 34, 55, "Input"],
Cell[49339, 1533, 592, 21, 54, "Output"]
}, Open  ]],
Cell[49946, 1557, 624, 22, 55, "Input"],
Cell[CellGroupData[{
Cell[50595, 1583, 635, 19, 55, InheritFromParent],
Cell[51233, 1604, 891, 30, 63, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[52161, 1639, 502, 16, 66, "Input"],
Cell[52666, 1657, 526, 17, 58, "Output"]
}, Open  ]],
Cell[53207, 1677, 552, 18, 53, "Input"],
Cell[CellGroupData[{
Cell[53784, 1699, 403, 13, 56, InheritFromParent],
Cell[54190, 1714, 352, 12, 52, "Output"]
}, Open  ]],
Cell[54557, 1729, 351, 13, 53, "Input"],
Cell[CellGroupData[{
Cell[54933, 1746, 379, 13, 53, InheritFromParent],
Cell[55315, 1761, 230, 8, 50, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[55582, 1774, 253, 9, 51, "Input"],
Cell[55838, 1785, 200, 7, 84, "Output"]
}, Open  ]],
Cell[56053, 1795, 330, 12, 53, "Input"],
Cell[CellGroupData[{
Cell[56408, 1811, 328, 11, 53, InheritFromParent],
Cell[56739, 1824, 179, 6, 50, "Output"]
}, Open  ]],
Cell[56933, 1833, 552, 18, 53, "Input"],
Cell[CellGroupData[{
Cell[57510, 1855, 346, 11, 53, InheritFromParent],
Cell[57859, 1868, 597, 17, 47, "Output"]
}, Open  ]],
Cell[58471, 1888, 598, 18, 53, InheritFromParent],
Cell[CellGroupData[{
Cell[59094, 1910, 713, 22, 55, InheritFromParent],
Cell[59810, 1934, 1212, 36, 56, "Output"]
}, Open  ]],
Cell[61037, 1973, 1257, 37, 58, "Input"],
Cell[CellGroupData[{
Cell[62319, 2014, 722, 22, 58, InheritFromParent],
Cell[63044, 2038, 722, 22, 56, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[63803, 2065, 766, 23, 58, "Input"],
Cell[64572, 2090, 1015, 31, 50, "Output"]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
